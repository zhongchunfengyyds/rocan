<?xml version="1.0" encoding="UTF-8"?>
<!-- author:littlebear -->
<sqlMap>
    <parameterMap class="commonj.sdo.DataObject" id="parameterMap">
        <parameter javaType="date" jdbcType="DATE" property="dateType"/>
    </parameterMap>
    <resultMap class="commonj.sdo.DataObject" id="resultMap">
        <result column="TYPEID" javaType="string" property="typeId"/>
    </resultMap>
    <select id="select_id" parameterMap="parameterMap" resultMap="resultMap"><![CDATA[sql statement]]></select>
    <select id="logicDele" parameterClass="java.util.Map" resultClass="java.lang.String">
		update T_WELDING_PROCESSCARD set isdel = '1',deletetime=#deletetime# where uuid = #id#
 	</select> 
 	<select id="recovery" parameterClass="java.util.Map" resultClass="java.lang.String">
		update T_WELDING_PROCESSCARD set isdel = '0',deletetime=null where uuid = #id#
 	</select>
 	
 	<select id="getProcessAssessmentReport" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		SELECT DISTINCT assessmentid as id,assessmentid as name,edition,assessmentunit,joint,method,position,specifications
		 from WELDING_ASSESSMENT where JD = #base# and isdel = 0 
		 <isNotNull prepend =" AND " property="assessmentid" >
		   		assessmentid like '%'+#assessmentid#+'%'
		 </isNotNull> 
		 
	</select>
	
	<!-- 焊接工艺卡 弹出框数据 -->
	<select id="getProcessCard" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		SELECT card_number,edition,welding_method FROM
				T_WELDING_PROCESSCARD
				where isdel = 0 and jd = #base#
			<isNotNull prepend =" AND " property="weldingMethod" >
		   		welding_method like '%'+#weldingMethod#+'%'
		 </isNotNull> 
		 order by createtime desc,orderno asc
	</select>
	
	<!-- 焊材 弹出框数据 -->
	<select id="getMaterial" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		select uuid,name,standard,model,brand,specifications,batchnumber,inventory,measurement,validuntil 
		from WELDING_MATERIAL where isdel = 0 and jd = #base#
		<isNotNull prepend =" AND " property="name" >
		   		name like '%'+#name#+'%'
		 </isNotNull> 
		 order by createtime desc,orderno asc
	</select>
	
	<select id="getWpsandEdition" parameterClass="java.lang.String" resultClass="commonj.sdo.DataObject">
	SELECT
	( card_number + '/' + edition ) AS name,
	( card_number + '/' + edition ) AS id
	FROM
		T_WELDING_PROCESSCARD
	where JD = #value# and isdel='0' and card_number is not null and edition is not null
	</select>
	
	<select id="getWelderMethod" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
	SELECT DISTINCT welding_method as name,welding_method as id FROM T_WELDING_PROCESSCARD where JD = #base# and isdel='0' and welding_method is not null
	and card_number=#card_number# and edition=#edition#
	</select>
	<select id="getWelderassessment" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
	
		SELECT  * FROM WELDING_ASSESSMENT where  isdel='0' 
		<isNotNull prepend =" AND " property="jd" >
		   		JD = #jd#
		   </isNotNull> 
		   <isNotNull prepend =" AND " property="assessmentid" >
		   		assessmentid = #assessmentid#
		   </isNotNull> 
	</select>
	
	<select id="getwpseditioncount" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
	SELECT count(1)count
	FROM
		T_WELDING_PROCESSCARD
	where JD = #jd# and isdel='0' and card_number=#card_number# and edition=#edition#
	</select>
</sqlMap>