<?xml version="1.0" encoding="UTF-8"?>
<!-- author:jirukang -->
<sqlMap>
    <parameterMap class="commonj.sdo.DataObject" id="parameterMap">
        <parameter javaType="date" jdbcType="DATE" property="dateType"/>
    </parameterMap>
    <resultMap class="commonj.sdo.DataObject" id="resultMap">
        <result column="TYPEID" javaType="string" property="typeId"/>
    </resultMap>
    <select id="select_id" parameterMap="parameterMap" resultMap="resultMap"><![CDATA[sql statement]]></select>
    
    <!--查询役检目录树所有的被检部位-->
    <select id="getdetectedsite" parameterClass="java.lang.String" resultClass="commonj.sdo.DataObject">
    SELECT detectedsite as name,detectedsite as id FROM T_INSPECOMPONENTMENUTREE where jd=#base# and jz=#crew#
    </select>
    
    <!--根据选择的被检部位查询所有的设备名称-->
    <select id="getdevicename"  parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
     		SELECT devicename as name,devicename as id FROM T_INSPECOMPONENTMENUTREE where jd=#base# and jz=#crew# and detectedsite=#detectedsite#
    </select>
    
    <!--根据选择的设备名称和被检部位查询所有的部件名称-->
    <select id="getpartname" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    SELECT partname as name,partname as id FROM T_INSPECOMPONENTMENUTREE where jd=#base# and jz=#crew# and devicename=#devicename# and detectedsite=#detectedsite#
	</select>
	
	<!--获取被检部位层级树-->
	<select id="gettreelist" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
	SELECT devicename, partname, detectedsite FROM T_INSPECOMPONENTMENUTREE where jd=#base# and jz=#crew#
	</select>
	
	<!--获取所有大修中最大编号-->
	<select id="getmaxdefetenum" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			SELECT MAX(defectdisplaynumber)defectdisplaynumber  FROM T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0'
	</select>
	
	<!--默认未选择大修情况 查询所有编号-->
	<select id="getallnum" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			SELECT DISTINCT defectdisplaynumber as id,defectdisplaynumber as name FROM T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0'
	</select>
	
	<!--获取所选大修中历史大修编号-->
	<select id="gethistorynumbyoverhaulsequence" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		SELECT DISTINCT defectdisplaynumber as id,defectdisplaynumber as name FROM T_DEFECTSSHOWDETAILEDINFORMATION t1 WHERE t1.overhaulsequence=#overhaulsequence# and jd=#base# and jz=#crew#
	</select>
	
	<!--获取模板下历史大修编号-->
	<select id="getHistoryNum" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		SELECT 
		DISTINCT defectdisplaynumber as id,
		defectdisplaynumber as name 
		FROM 
		T_DEFECTSSHOWDETAILEDINFORMATION 
		WHERE 
		 isdel = '0'
       <isNotNull prepend=" AND " property="base">
		  	  jd=#base#
		  </isNotNull>
		   <isNotNull prepend=" AND " property="crew">
		  	  jz=#crew#
		  </isNotNull>
		   <isNotNull prepend=" AND " property="stencilplate">
		  	  stencilplate=#stencilplate#
		  </isNotNull>
		   <isNotNull prepend=" AND " property="overhaulsequence">
		  	   overhaulsequence=#overhaulsequence#
		  </isNotNull>
		 	order by defectdisplaynumber desc
	</select>
	
	<!--获取当前缺陷数据中的所有的大修轮次-->
	<select id="getalloverhaulsequence" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		select DISTINCT overhaulsequence as id,overhaulsequence as name from T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and overhaulsequence is not null and isdel='0'
	</select>
		<!--获取模板下的大修轮次-->
	<select id="getOverHaulByTemplate" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
		select 
		DISTINCT overhaulsequence as id,
		overhaulsequence as name 
		from T_DEFECTSSHOWDETAILEDINFORMATION 
		where  isdel='0'
		  <isNotNull prepend=" AND " property="JD">
		  	  jd=#base#
		  </isNotNull>
		   <isNotNull prepend=" AND " property="JZ">
		  	  jz=#crew#
		  </isNotNull>
		   <isNotNull prepend=" AND " property="STENCILPLATE">
		  	  stencilplate=#stencilplate#
		  </isNotNull>
		and overhaulsequence is not null 
		order by overhaulsequence
	</select>
	
	<!--获取当前缺陷数据中的最小的排序编号-->
	<select id="getminsortfield" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
	select min(sortfield) sortfield from T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0'
	</select>
	
	<!-- 获取不同方法下的大修对应的缺陷数据的总数 -->
    <select id="getdefectnumbersum" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    	select count(1) count from T_DEFECTSSHOWDETAILEDINFORMATION where overhaulsequence=#overhaulsequence# and stencilplate=#stencilplate#
    	and jd=#base# and jz=#crew# and isdel='0'
    </select>
    
    <!-- 获取某一大修下以及某个检查方法下的缺陷类型 -->
    <select id="getdefecttype" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    select DISTINCT defecttype as id,defecttype as name from T_DEFECTSSHOWDETAILEDINFORMATION where overhaulsequence=#overhaulsequence# and jd=#base# and jz=#crew# and stencilplate=#stencilplate# and defecttype is not null
	</select>
	
	<!-- 获取不同方法下的大修对应的缺陷类型数据的总数 -->
	<select id="getnumsbydefecttype" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			select count(1) count from T_DEFECTSSHOWDETAILEDINFORMATION where overhaulsequence=#overhaulsequence# and stencilplate=#stencilplate#
    	and jd=#base# and defecttype=#defecttype# and jz=#crew# and isdel='0'
	</select>
	
	<!-- 获取对应基地机组下的缺陷编号的总数 -->
	<select id="getdefectnumbercount" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			select count(1) count from T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0' and stencilplate=#stencilplate#
	</select>
	
	<!--获取所有大修中最大编号-->
	<select id="getmaxdefetenumbymodel" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			SELECT MAX(defectdisplaynumber)defectdisplaynumber  FROM T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0' and stencilplate=#stencilplate#
	</select>
	
	<!--获取所有大修中最大编号-->
	<select id="getmaxnullorder" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
			SELECT MAX(nullorder)nullorder  FROM T_DEFECTSSHOWDETAILEDINFORMATION where jd=#base# and jz=#crew# and isdel='0' and stencilplate=#stencilplate#
	</select>
</sqlMap>