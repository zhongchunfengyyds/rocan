<?xml version="1.0" encoding="UTF-8"?>
<!-- author:SWH -->
<sqlMap>
    <parameterMap class="commonj.sdo.DataObject" id="parameterMap">
        <parameter javaType="date" jdbcType="DATE" property="dateType"/>
    </parameterMap>
    <resultMap class="commonj.sdo.DataObject" id="resultMap">
        <result column="TYPEID" javaType="string" property="typeId"/>
    </resultMap>
    <select id="select_id" parameterMap="parameterMap" resultMap="resultMap"><![CDATA[sql statement]]></select>
    
    
    <select id="getMachinepagedata" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    	select *
 FROM WELDING_MACHINE t1
 where t1.isdel=0
    	<isNotNull prepend =" AND " property="jd" >
		   		JD = #jd# 
		   </isNotNull> 
    	 <isNotNull property="Identification">
                and uuid in
                <iterate property="Identification" conjunction="," open="(" close=")">
                    #Identification[]#
                </iterate>
         </isNotNull>
         <isNotNull property="already">
                and uuid not in
                <iterate property="already" conjunction="," open="(" close=")">
                    #already[]#
                </iterate>
         </isNotNull>
         <isNotNull prepend =" AND " property="name" >
		   	name like '%'+#name#+'%'
		   </isNotNull> 
		   <isNotNull prepend =" AND " property="number" >
		   		number like '%'+#number#+'%'  
		   </isNotNull> 
		   <isNotNull prepend =" AND " property="state" >
		   		state= #state# 
		   </isNotNull> 
		   order by createtime desc
 	</select>
 	<select id="queryMachineList" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    	select t3.*
			FROM
			T_DXGL_ZZSQGL_RELATION t1
			left join T_DXGL_ZZSQGL_REMINDER t2 on t2.uuid=t1.checkid
			left join WELDING_MACHINE t3 on t1.number=t3.uuid
			where t3.isdel=0 and t2.relationtype='Mac'
    	<isNotNull prepend =" AND " property="jd" >
		   		 t3.jd = #jd# 
	   		</isNotNull> 
         <isNotNull prepend =" AND " property="checkid">
                t1.checkid =#checkid#
         </isNotNull>
         <isNotNull prepend =" AND " property="relationType">
                t1.relationType=#relationType#
         </isNotNull>
         <isNotNull prepend =" AND " property="advanceday">
               t2.state='1' and   datediff(day,GETDATE(),verification)&lt;=#advanceday# and datediff(day,GETDATE(),verification)-#duration#&lt;=0
                and datediff(day,GETDATE(),verification)>=0
         </isNotNull>
 	</select>
 	
 	<select id="queryMachineListdic" parameterClass="java.util.Map" resultClass="commonj.sdo.DataObject">
    	select t4.DICTNAME as state,t5.DICTNAME as location,CONVERT(varchar(100),convert(datetime,t3.verification), 23) verification,t3.*
			FROM
			T_DXGL_ZZSQGL_RELATION t1
			left join T_DXGL_ZZSQGL_REMINDER t2 on t2.uuid=t1.checkid
			left join WELDING_MACHINE t3 on t1.number=t3.uuid
			LEFT JOIN EOS_DICT_ENTRY t4 ON t4.DICTID = t3.state
				AND t4.DICTTYPEID ='HJGLZT'
			LEFT JOIN EOS_DICT_ENTRY t5 ON t5.DICTID = t3.location
				AND t5.DICTTYPEID ='SZWZ'
			where t3.isdel=0 and t2.relationtype='Mac'
    	<isNotNull prepend =" AND " property="jd" >
		   		 t3.jd = #jd# 
	   		</isNotNull> 
         <isNotNull prepend =" AND " property="checkid">
                t1.checkid =#checkid#
         </isNotNull>
         <isNotNull prepend =" AND " property="relationType">
                t1.relationType=#relationType#
         </isNotNull>
         <isNotNull prepend =" AND " property="advanceday">
               t2.state='1' and   datediff(day,GETDATE(),verification)-#advanceday#+#duration#&gt;=0 and datediff(day,GETDATE(),verification)-#advanceday#+#duration#&lt;=#duration#
                
         </isNotNull>
 	</select>
 	
    <select id="queryMachineQR" parameterClass="java.lang.String" resultClass="commonj.sdo.DataObject">
			select uuid,t4.name as JD,t1.name,number,equipmenttype,
input,currentrange,manufacturer,convert(varchar(10),verification,120) as verification,t2.DICTNAME as state
,t3.DICTNAME as locations from WELDING_MACHINE t1 
LEFT JOIN EOS_DICT_ENTRY t2 ON t2.DICTID = t1.state
AND t2.DICTTYPEID ='HJGLZT'
LEFT JOIN EOS_DICT_ENTRY t3 ON t3.DICTID = t1.location
AND t3.DICTTYPEID ='SZWZ'
LEFT JOIN TD_DXGL_JDDICT t4 ON t4.id= t1.jd    	
			 where uuid=#id#	
 	</select>
 	
 	<select id="queryMachine" parameterClass="java.util.Map" resultClass="com.cgn.itmp.weldingmanagement.Machine.Machine">
    	select * from WELDING_MACHINE where isdel='0'
    	<isNotNull prepend =" AND " property="jd" >
		   		 jd = #jd# 
	   		</isNotNull> 
	   		<isNotNull prepend =" AND " property="state" >
		   		 state=#state# 
	   		</isNotNull> 
	   		<isNotNull prepend =" AND " property="number" >
		   		 number like '%'+#number#+'%' 
	   		</isNotNull> 
	   		<isNotNull prepend =" AND " property="name" >
		   		 name like '%'+#name#+'%'
	   		</isNotNull>
	   		<isNotNull prepend =" AND " property="uuids" >
		   		    uuid not in
                <iterate property="uuids" conjunction="," open="(" close=")">
                    #uuids[]#
                </iterate>
	   		</isNotNull>
	   		order by createtime desc,orderno asc
 	</select>
</sqlMap>